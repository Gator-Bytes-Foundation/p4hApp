<!DOCTYPE html>

{% extends "header.html" %} <!-- all html files should extend from the header, (the header contains all static references as well) --> 
{% block content %} <!-- this appears when looking at html but if running Flask, will not appear (needed for extending from header.html -->
  
<div class="container emp-profile">
<form method="post">
<div class="row">
  <div class="col-3">
    {% if user.name == 'Admin' %}
    <img class="image-cropper img-fluid rounded-circle" alt="placeholder" src="../static/images/p4h.png"</img>
    {% else %}
    <figure class="image-cropper img-fluid rounded-circle"><img alt="placeholder" src="{{user.avatar_url}}"/></figure>
    {% endif %}
  </div>
  <div class="col-8 col-sm-8 ">
    <h4>{{user.name}}</h4>
    <small class=""> <b>Pozisyon:</b> Elementary Teacher </small> <br>
    <small> <b>De Mwen :</b> Mwen anseye lekòl elemantè</small> </div>
</div>
<!--<div class="input-group"> 
          <div class="input-group-prepend"> <span class="input-group-text" id="inputGroupFileAddon01">Upload</span> </div>
            <div class="custom-file">
              <input type="file" class="custom-file-input" id="inputGroupFile01"
      aria-describedby="inputGroupFileAddon01">
              <label class="custom-file-label" for="inputGroupFile01">Choose file</label> -->

<div class="col-md-6 col-12">
  <div id="mytabs" class="profile-head">
    <ul class="nav nav-tabs"  role="tablist">
      <li class="nav-item"> <a class="nav-link"  href="#about" aria-controls="about" id="about-tab" rel="about" data-toggle="tab"  role="tab"  aria-selected="true">About</a> </li>
      <li class="nav-item"> <a class="nav-link" href="#timeline" aria-controls="timeline"  id="timeline-tab" rel="timeline" data-toggle="tab" role="tab"  aria-selected="false">Timeline</a> </li>
    </ul>
  </div>
</div>
<div class="row">
  <div class="col-4">
    <input type="submit" class="profile_button" name="edit" value="Edit Profile"/>
  </div>
  <div class="col-8">
    <button type="button" class="profile_button">Pwogre Mwen (progress)</button>
  </div>
</div>
<div class="col-md-10 col-12 ">
<div class="tab-content profile-tab ">
  <div id="timeline" class="profile-work tab-pane fade active show in" role="tabpanel"> 
    <!-- 1st tab {% if active=='timeline' %}show active{% endif %}-->
    <h3>Prowfil Pos</h3>
      <div id="write_post"> 
        <div style="text-align: center;" class="post_box row">
          {% if user.name == 'Admin' %}
          <figure class="thumbnail col-2"><img alt="placeholder"class="img-fluid rounded-circle" src="../static/images/p4h.png"/></figure>
          {% else %}
          <figure class="thumbnail col-2"><img alt="placeholder"class="img-fluid rounded-circle" src="{{user.avatar_url}}"/></figure>
          {% endif %}
          <div class="col-9" id="">
            <textarea class="text_box" name="message" id="textbox_post" style="width: 100%;" placeholder="Write Post Here" onkeyup="Expand(this);" size="5" ></textarea><span class="oi oi-cloud-download upload_icon" aria-hidden="true"></span>

          </div>
          <a href="#" name="action" id="post" value="Post" style="width:100%;" class="profile_button btn-sm">Post</a>
        </div>
      </div>
      <!-- Post Loop --> 
      {% for i in range(posts | length)%}
        {% include 'post.html' %}
      {% endfor %}
  </div>
  <div id="about"  class="tab-pane fade in" role="tabpanel">
    <div class="row">
      <div class="col-md-6">
        <label>User Id</label>
      </div>
      <div class="col-md-6">
        <p>lcundiff</p>
      </div>
    </div>
    <div class="row">
      <div class="col-md-6">
        <label>Name</label>
      </div>
      <div class="col-md-6">
        <p>Logan</p>
      </div>
    </div>
    <div class="row">
      <div class="col-md-6">
        <label>Email</label>
      </div>
      <div class="col-md-6">
        <p>lcundiff@gmail.com</p>
      </div>
    </div>
    <div class="row">
      <div class="col-md-6">
        <label>Phone</label>
      </div>
      <div class="col-md-6">
        <p>123 456 7890</p>
      </div>
    </div>
    <div class="row">
      <div class="col-md-6">
        <label>Profession</label>
      </div>
      <div class="col-md-6">
        <p>Elementary Teacher</p>
      </div>
    </div>
  </div>
  </form>
</div>
<script type="text/javascript">
  $(document).ready(function(){
      //  When user clicks on tab, this code will be executed
    $('#timeline-tab').addClass("active");
    $('#timeline-tab').addClass("show");
  });
</script> 

<script type="text/javascript">
$(document).on("click", ".reply_button", function(e) { /* old regular expression I was using to find all reply ids: a[id|='reply' */ 
  e.preventDefault();
  var id_number = e.currentTarget.name;
  console.log("comment_id " + id_number);
  var value = $("#textbox_reply-"+id_number).val();
  console.log(value);
    
  //alert(value);
  $.ajax({
      type: "POST",
      url: "/comment_"+id_number,
      data: JSON.stringify({ "text" : value } ),
      contentType: "application/json; charset=utf-8",
      dataType: "text",
      error: function(data) {
        response = eval(data);
        comment = JSON.stringify(response);
        console.log("error" + comment)  
      },
      success: function (data) {
          comment = data;
          console.log("ajax return comment ", comment)
          $("#comments-"+id_number).append(comment);  

      }
  });
  
});
// handle posts
$("#post").on("click", function(e) { 
  e.preventDefault();
  var value = $("#textbox_post").val();
  console.log(value);    
    //alert(value);
    $.ajax({
        type: "POST",
        url: "/post",
        data: JSON.stringify({ "text" : value } ),
        contentType: "application/json; charset=utf-8",
        dataType: "text",
        error: function(data) {
          response = eval(data);
          post = JSON.stringify(response);
          console.log("error" + post)  
        },
        success: function (data) {
            post = data;
            //console.log(post)
            $("#write_post").append(post);

        }
    });
});
  // handle textbox 
$(function() {
    //  changes mouse cursor when highlighting loawer right of box
    $("textarea").mousemove(function(e) {
        var myPos = $(this).offset();
        myPos.bottom = $(this).offset().top + $(this).outerHeight();
        myPos.right = $(this).offset().left + $(this).outerWidth();
        
        if (myPos.bottom > e.pageY && e.pageY > myPos.bottom - 16 && myPos.right > e.pageX && e.pageX > myPos.right - 16) {
            $(this).css({ cursor: "nw-resize" });
        }
        else {
            $(this).css({ cursor: "" });
        }
    })
    //  the following simple make the textbox "Auto-Expand" as it is typed in
    .css('overflow', 'hidden').keyup(function(e) {
        //  this if statement checks to see if backspace or delete was pressed, if so, it resets the height of the box so it can be resized properly
        if (e.which == 8 || e.which == 46) {
            $(this).height(parseFloat($(this).css("min-height")) != 0 ? parseFloat($(this).css("min-height")) : parseFloat($(this).css("font-size")));
        }
        //  the following will help the text expand as typing takes place
        while($(this).outerHeight() < this.scrollHeight + parseFloat($(this).css("borderTopWidth")) + parseFloat($(this).css("borderBottomWidth"))) {
            $(this).height($(this).height()+1);
        };
    });
});
</script> 

{% endblock %} <!-- this appears when looking at html but if running Flask, will not appear (needed for extending from header.html --> 